(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-64e7"],{"7ZQD":function(e,t,a){},"97R0":function(e,t,a){"use strict";var i=a("wRyu");a.n(i).a},"9FIO":function(e,t,a){"use strict";var i=a("kLfe");a.n(i).a},Jbo4:function(e,t,a){"use strict";var i={name:"WkBorderMenu",components:{},props:{list:Array,value:[String,Number],isSelect:{type:Boolean,default:!1}},data:function(){return{tabType:""}},computed:{},watch:{value:{handler:function(e){this.tabType=e},immediate:!0}},mounted:function(){},beforeDestroy:function(){},methods:{tabClick:function(e,t){this.$emit("input",e.name),this.$emit("select",e,t)}}},s=(a("fUY0"),a("KHd+")),r=Object(s.a)(i,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("flexbox",{staticClass:"wk-border-menu",class:{"is-select":e.isSelect}},e._l(e.list,function(t,i){return a("div",{key:i,staticClass:"wk-border-menu__item",class:{"is-select":e.tabType==t.name},on:{click:function(a){e.tabClick(t,i)}}},[a("div",{staticClass:"label"},[e._v(e._s(t.label))]),e._v(" "),a("div",{staticClass:"num"},[e._v(e._s(t.num))])])}))},[],!1,null,"8dc40426",null);r.options.__file="index.vue";t.a=r.exports},Kti4:function(e,t,a){"use strict";a.r(t);var i=a("QbLZ"),s=a.n(i),r=a("cZXy"),n=a("9GgJ"),l=a("jpO5"),o=a("lH/j"),u=a("zMw6"),c=a("cHj4"),p=a("gVZb"),d=a("EP+0"),m=a("XAon"),f=a("jPAu"),h=a("3pgX"),v=a("7Qib"),b={name:"PerformanceCreateView",components:{XrCreate:p.a,CreateSections:d.a,WkUserSelect:m.a,WkUserDepSelect:f.a,WkDepSelect:h.a},filters:{},props:{id:[String,Number],status:[String,Number]},data:function(){var e=this,t=function(t,a,i){e.baseForm.startTime&&e.baseForm.endTime&&Object(v.k)(e.baseForm.startTime)>=Object(v.k)(e.baseForm.endTime)&&i(new Error("开始时间必须小于结束时间")),i()};return{loading:!1,detail:null,baseRules:{appraisalName:{required:!0,message:"不能为空",trigger:["blur","change"]},cycleType:{required:!0,message:"请选择",trigger:["blur","change"]},startTime:[{required:!0,message:"请选择",trigger:["blur","change"]},{validator:t,trigger:"blur"}],endTime:[{required:!0,message:"请选择",trigger:["blur","change"]},{validator:t,trigger:"blur"}],tableId:{required:!0,message:"请选择",trigger:["blur","change"]},writtenBy:{required:!0,message:"不能为空",trigger:["blur","change"]},targetConfirmorsList:{required:!0,message:"请选择",trigger:["blur","change"]},evaluatorsList:{required:!0,message:"请选择",trigger:["blur","change"]},resultConfirmors:{required:!0,message:"请选择",trigger:["blur","change"]},scoreLevelList:{required:!0,message:"请选择",trigger:["blur","change"]}},resultConfirmorsDisabled:!1,baseForm:{range:[1],writtenBy:1,cycleType:1,targetConfirmorsList:[{type:1,employeeId:""}],evaluatorsList:[{type:1,weight:"100",employeeId:""}],fullScore:100,scoreLevelList:[{levelName:"S",minScore:"85",maxScore:"100",minNum:"10",maxNum:"15"},{levelName:"A",minScore:"75",maxScore:"84",minNum:"50",maxNum:"55"},{levelName:"B",minScore:"60",maxScore:"74",minNum:"30",maxNum:"35"},{levelName:"C",minScore:"0",maxScore:"59",minNum:"10",maxNum:"15"}],isForce:0},tableList:[],cycleTypeList:[{label:"月",value:1},{label:"季",value:2},{label:"年",value:3},{label:"半年",value:4}],userTypeList:[{label:"员工本人",value:1},{label:"直属上级",value:2},{label:"所在部门负责人",value:3},{label:"上级部门负责人",value:4},{label:"指定目标确认人",value:5}],evaluatorTypeList:[{label:"员工本人",value:1},{label:"直属上级",value:2},{label:"所在部门负责人",value:3},{label:"上级部门负责人",value:4},{label:"指定结果评定人",value:5}],userList:[]}},inject:["editAuth"],computed:{titleContent:function(){return this.id?"考核设置":"新建考核"},optionsType:function(){return this.id?this.editAuth?this.detail&&1===this.detail.isStop?0:0==this.status?10:1==this.status?9:2==this.status?8:0:0:10},resultUserList:function(){if(this.optionsType<8){var e=(this.detail&&this.detail.resultConfirmors?this.detail.resultConfirmors:[]).map(function(e){return e.employeeId}),t=[];return this.userList.forEach(function(a){var i=s()({},a),r=e.includes(a.employeeId);i.isHide=r,i.disabled=r&&1==i.status,t.push(i)}),t}return this.userList}},watch:{id:{handler:function(e){e&&this.getDetail()},immediate:!0}},created:function(){this.getTableList(),this.getUserList()},mounted:function(){},beforeDestroy:function(){},methods:{getDetail:function(){var e=this;this.detail=null,this.loading=!0,Object(r.c)(this.id).then(function(t){if(e.loading=!1,e.detail=t.data,e.detail){e.detail.range=[1],e.baseForm=Object(v.w)(e.detail);var a=e.baseForm.resultConfirmors||[];e.resultConfirmorsDisabled=!a.find(function(e){return 1!=e.status})}}).catch(function(){e.loading=!1})},close:function(){this.$emit("close")},getTableList:function(){var e=this;this.loading=!0,Object(u.g)().then(function(t){e.loading=!1,e.tableList=t.data||[]}).catch(function(){e.loading=!1})},getUserList:function(){var e=this;Object(c.i)().then(function(t){var a=t.data||[];a.forEach(function(e){e.isHide=1!=e.status}),e.userList=a,e.loading=!1}).catch(function(){e.loading=!1})},addConfirmClick:function(){this.baseForm.targetConfirmorsList.push({type:1,employeeId:""})},deleteItemClick:function(e,t){e.splice(t,1)},addEvaluatorClick:function(){this.baseForm.evaluatorsList.push({type:1,employeeId:"",weight:""})},addScoreLevelClick:function(){this.baseForm.scoreLevelList.push({levelName:""})},getTypeEmployeeIdRules:function(e){return{validator:function(t,a,i){5!=e.type||a?i():i(new Error("请选择"))},trigger:["change","blur"],data:e}},getTypeWeightRules:function(e){var t=this;return{validator:function(e,a,i){if(a<0||a>100||null===a||void 0===a||""===a)i(new Error("范围在0-100之间"));else if(t.baseForm.evaluatorsList.length){var s=0;t.baseForm.evaluatorsList.forEach(function(e){s+=parseInt(e.weight)}),100!=s&&e.index==t.baseForm.evaluatorsList.length-1?i(new Error("权重之和需等于100")):i()}},trigger:["blur","change"],index:e}},getProportionRules:function(e,t,a){var i=this;return{validator:function(e,t,a){if(t<0||t>100||null===t||void 0===t||""===t)a(new Error("范围在0-100之间"));else if(parseInt(e.data.maxNum||0)<parseInt(e.data.minNum||0))a(new Error("下限值不能大于上限值"));else if(i.baseForm.scoreLevelList.length){var s=0,r=0;i.baseForm.scoreLevelList.forEach(function(e){s=Object(v.i)(s,e.minNum),r=Object(v.i)(r,e.maxNum)}),s>100&&"min"==e.type?e.index==i.baseForm.scoreLevelList.length-1&&a(new Error("下限值之和不能大于100")):r<100&&"max"==e.type?e.index==i.baseForm.scoreLevelList.length-1&&a(new Error("上限值应大于等于100")):a()}},trigger:["blur"],data:e,index:t,type:a}},getFullScoreRules:function(){return{validator:function(e,t,a){t<1||t>99999||null===t||void 0===t||""===t?a(new Error("范围在1-99999之间")):a()},trigger:["blur"]}},getRangeRules:function(){var e=this;return{validator:function(t,a,i){e.baseForm.employeeIds&&e.baseForm.employeeIds.length||e.baseForm.deptIds&&e.baseForm.deptIds.length?i():i(new Error("选择考核范围"))},trigger:["change"]}},getScoreRules:function(e,t,a){var i=this;return{validator:function(e,t,a){if(i.baseForm.fullScore)if(t<0||t>parseInt(i.baseForm.fullScore)||null===t||void 0===t||""===t)a(new Error("范围在0-"+i.baseForm.fullScore+"之间"));else if(parseInt(e.data.maxScore||0)<parseInt(e.data.minScore||0))a(new Error("下限值不能大于上限值"));else{if(e.index>0){var s=i.baseForm.scoreLevelList[e.index-1];if(parseInt(s.minScore||0)<=parseInt(t||0))return void a(new Error("须小于上一等级下限值"))}a()}else a()},trigger:["blur"],data:e,index:t,type:a}},inputBlurValidate:function(e,t,a){"num"==e?this.$refs.baseForm.validateField("scoreLevelList["+t+"]."+("min"==a?"maxNum":"minNum")):"score"==e&&this.$refs.baseForm.validateField("scoreLevelList["+t+"]."+("min"==a?"maxScore":"minScore"))},weightInputChange:function(e){e.weight=e.weight.replace(/[^\d]/g,"")},weightInputBlur:function(){for(var e=this.baseForm.evaluatorsList.length,t=0;t<e;t++)this.$refs.baseForm.validateField("evaluatorsList["+t+"].weight")},saveClick:function(){var e=this;this.$refs.baseForm.validate(function(t){t&&e.uploadCreateData()})},uploadCreateData:function(){var e=this,t=Object(v.w)(this.baseForm);this.id&&(t.appraisalId=this.id),delete t.range,this.loading=!0,(this.id?r.j:r.a)(t).then(function(t){e.$emit("close"),e.$message.success(e.titleContent+"成功"),e.$emit("success"),e.loading=!1}).catch(function(){e.loading=!1})}}},g=(a("9FIO"),a("KHd+")),y=Object(g.a)(b,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("xr-create",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{title:e.titleContent},on:{close:e.close,save:e.saveClick}},[a("create-sections",{attrs:{title:"基本信息"}},[a("el-form",{ref:"baseForm",attrs:{model:e.baseForm,rules:e.baseRules}},[a("div",{staticClass:"base-info-section"},[a("el-form-item",{attrs:{prop:"appraisalName"}},[a("template",{slot:"label"},[e._v("\n            考核名称\n          ")]),e._v(" "),a("el-input",{attrs:{disabled:10!=e.optionsType,maxlength:100},model:{value:e.baseForm.appraisalName,callback:function(t){e.$set(e.baseForm,"appraisalName",t)},expression:"baseForm.appraisalName"}})],2),e._v(" "),a("el-form-item",{attrs:{prop:"cycleType"}},[a("template",{slot:"label"},[e._v("\n            考核时间\n          ")]),e._v(" "),a("el-radio-group",{staticStyle:{width:"100%"},attrs:{disabled:10!=e.optionsType},model:{value:e.baseForm.cycleType,callback:function(t){e.$set(e.baseForm,"cycleType",t)},expression:"baseForm.cycleType"}},e._l(e.cycleTypeList,function(t,i){return a("el-radio",{key:i,attrs:{label:t.value}},[e._v("\n              "+e._s(t.label)+"\n            ")])}))],2),e._v(" "),a("el-form-item",{attrs:{prop:"startTime"}},[a("template",{slot:"label"},[e._v("\n            考核开始时间\n          ")]),e._v(" "),a("el-date-picker",{staticStyle:{width:"100%"},attrs:{disabled:10!=e.optionsType,clearable:"",type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.baseForm.startTime,callback:function(t){e.$set(e.baseForm,"startTime",t)},expression:"baseForm.startTime"}})],2),e._v(" "),a("el-form-item",{attrs:{prop:"endTime"}},[a("template",{slot:"label"},[e._v("\n            考核结束时间\n          ")]),e._v(" "),a("el-date-picker",{staticStyle:{width:"100%"},attrs:{disabled:10!=e.optionsType,clearable:"",type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.baseForm.endTime,callback:function(t){e.$set(e.baseForm,"endTime",t)},expression:"baseForm.endTime"}})],2),e._v(" "),a("el-form-item",{attrs:{prop:"tableId"}},[a("template",{slot:"label"},[e._v("\n            考核表模板\n          ")]),e._v(" "),a("el-select",{staticStyle:{width:"100%"},attrs:{disabled:10!=e.optionsType},model:{value:e.baseForm.tableId,callback:function(t){e.$set(e.baseForm,"tableId",t)},expression:"baseForm.tableId"}},e._l(e.tableList,function(e,t){return a("el-option",{key:t,attrs:{label:e.tableName,value:e.tableId}})}))],2)],1),e._v(" "),a("div",{staticClass:"other-info-section"},[a("el-form-item",{attrs:{prop:"writtenBy"}},[a("template",{slot:"label"},[e._v("\n            考核目标填写人\n          ")]),e._v(" "),a("div",[e._v("本人")])],2),e._v(" "),a("el-form-item",{attrs:{prop:"targetConfirmorsList"}},[a("template",{slot:"label"},[e._v("\n            考核目标确认人"),a("el-tooltip",{attrs:{content:"按照添加的目标确认人顺序对考核目标进行确认",effect:"dark",placement:"top"}},[a("i",{staticClass:"wk wk-help wk-help-tips"})])],1),e._v(" "),e._l(e.baseForm.targetConfirmorsList,function(t,i){return a("flexbox",{key:i,staticClass:"user-data-row"},[a("el-form-item",{attrs:{prop:"targetConfirmorsList["+i+"].type",rules:{required:!0,message:"请选择",trigger:"change"},label:""}},[a("el-select",{attrs:{disabled:10!=e.optionsType},model:{value:t.type,callback:function(a){e.$set(t,"type",a)},expression:"confirm.type"}},e._l(e.userTypeList,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),5==t.type?a("el-form-item",{attrs:{prop:"targetConfirmorsList["+i+"].employeeId",rules:e.getTypeEmployeeIdRules(t),label:""}},[a("wk-user-select",{attrs:{disabled:10!=e.optionsType&&1==t.status,options:e.userList,props:{label:"employeeName",value:"employeeId",isList:!0},radio:""},model:{value:t.employeeId,callback:function(a){e.$set(t,"employeeId",a)},expression:"confirm.employeeId"}})],1):e._e(),e._v(" "),10==e.optionsType?a("i",{staticClass:"el-icon-remove",on:{click:function(t){e.deleteItemClick(e.baseForm.targetConfirmorsList,i)}}}):e._e()],1)}),e._v(" "),10==e.optionsType?a("div",{staticClass:"add-bar"},[a("el-button",{attrs:{icon:"el-icon-plus",type:"text"},on:{click:e.addConfirmClick}},[e._v("添加目标确认人")])],1):e._e()],2),e._v(" "),a("el-form-item",{attrs:{prop:"evaluatorsList"}},[a("template",{slot:"label"},[e._v("\n            考核结果评定人"),a("el-tooltip",{attrs:{content:"按照添加的结果评定人顺序对考核结果进行评定",effect:"dark",placement:"top"}},[a("i",{staticClass:"wk wk-help wk-help-tips"})])],1),e._v(" "),e._l(e.baseForm.evaluatorsList,function(t,i){return a("flexbox",{key:i,staticClass:"user-data-row"},[a("el-form-item",{attrs:{prop:"evaluatorsList["+i+"].type",rules:{required:!0,message:"请选择",trigger:"change"},label:""}},[a("el-select",{attrs:{disabled:e.optionsType<9},model:{value:t.type,callback:function(a){e.$set(t,"type",a)},expression:"evaluator.type"}},e._l(e.evaluatorTypeList,function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("div",{staticClass:"weight-label"},[e._v("权重")]),e._v(" "),a("el-form-item",{attrs:{prop:"evaluatorsList["+i+"].weight",rules:e.getTypeWeightRules(i),label:""}},[a("el-input",{directives:[{name:"wk-number",rawName:"v-wk-number",value:"positiveInt",expression:"'positiveInt'"}],staticStyle:{width:"120px"},attrs:{disabled:e.optionsType<9,type:"text"},on:{blur:e.weightInputBlur},model:{value:t.weight,callback:function(a){e.$set(t,"weight",a)},expression:"evaluator.weight"}},[a("template",{slot:"append"},[e._v("%")])],2)],1),e._v(" "),5==t.type?a("el-form-item",{attrs:{prop:"evaluatorsList["+i+"].employeeId",rules:e.getTypeEmployeeIdRules(t),label:""}},[a("wk-user-select",{attrs:{disabled:e.optionsType<9&&1==t.status,options:e.userList,props:{label:"employeeName",value:"employeeId",isList:!0},radio:""},model:{value:t.employeeId,callback:function(a){e.$set(t,"employeeId",a)},expression:"evaluator.employeeId"}})],1):e._e(),e._v(" "),e.optionsType>=9?a("i",{staticClass:"el-icon-remove",on:{click:function(t){e.deleteItemClick(e.baseForm.evaluatorsList,i)}}}):e._e()],1)}),e._v(" "),e.optionsType>=9?a("div",{staticClass:"add-bar"},[a("el-button",{attrs:{icon:"el-icon-plus",type:"text"},on:{click:e.addEvaluatorClick}},[e._v("添加评定人")])],1):e._e()],2),e._v(" "),a("el-form-item",{attrs:{prop:"resultConfirmors"}},[a("template",{slot:"label"},[e._v("\n            考核结果确认人"),a("el-tooltip",{attrs:{content:"考核结果确认人将对整个考核计划进行确认",effect:"dark",placement:"top"}},[a("i",{staticClass:"wk wk-help wk-help-tips"})])],1),e._v(" "),a("wk-user-select",{staticStyle:{width:"352px"},attrs:{disabled:e.optionsType<8&&e.resultConfirmorsDisabled,options:e.resultUserList,props:{label:"employeeName",value:"employeeId",isList:!0},radio:!1},model:{value:e.baseForm.resultConfirmors,callback:function(t){e.$set(e.baseForm,"resultConfirmors",t)},expression:"baseForm.resultConfirmors"}})],2),e._v(" "),a("el-form-item",{attrs:{prop:"scoreLevelList"}},[a("template",{slot:"label"},[e._v("\n            考核规则\n          ")]),e._v(" "),a("el-form-item",{attrs:{rules:e.getFullScoreRules(),prop:"fullScore",label:""}},[a("el-input",{directives:[{name:"wk-number",rawName:"v-wk-number",value:"positiveInt",expression:"'positiveInt'"}],staticStyle:{width:"120px"},attrs:{disabled:10!=e.optionsType,type:"text"},model:{value:e.baseForm.fullScore,callback:function(t){e.$set(e.baseForm,"fullScore",t)},expression:"baseForm.fullScore"}},[a("template",{slot:"append"},[e._v("分")])],2),e._v(" "),a("el-checkbox",{attrs:{"false-label":0,"true-label":1,disabled:10!=e.optionsType},model:{value:e.baseForm.isForce,callback:function(t){e.$set(e.baseForm,"isForce",t)},expression:"baseForm.isForce"}},[e._v("开启强制分布")]),a("el-tooltip",{attrs:{effect:"dark",placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[a("div",[e._v("1.开启强制分布：结果确认人确认时，超过规定比例不能确认通过")]),e._v(" "),a("div",[e._v("2.不开启强制分布：结果确认人确认时，超过规定比例也能确认通过")])]),e._v(" "),a("i",{staticClass:"wk wk-help wk-help-tips"})])],1),e._v(" "),a("div",{staticClass:"wk-text-tips"},[e._v("注：评分等级从上到下排序对应评分等级从高到底")]),e._v(" "),e._l(e.baseForm.scoreLevelList,function(t,i){return a("flexbox",{key:i,staticClass:"weight-data-row"},[a("div",{staticClass:"column"},[0==i?a("div",{staticClass:"label"},[e._v("等级")]):e._e(),e._v(" "),a("el-form-item",{attrs:{prop:"scoreLevelList["+i+"].levelName",rules:{required:!0,message:"请输入",trigger:"change"},label:""}},[a("el-input",{staticStyle:{width:"120px"},attrs:{disabled:10!=e.optionsType,type:"text"},model:{value:t.levelName,callback:function(a){e.$set(t,"levelName",a)},expression:"scoreLevel.levelName"}})],1)],1),e._v(" "),a("div",{staticClass:"column"},[0==i?a("div",{staticClass:"label"},[e._v("分数范围")]):e._e(),e._v(" "),a("flexbox",[a("el-form-item",{attrs:{prop:"scoreLevelList["+i+"].minScore",rules:e.getScoreRules(t,i,"min"),label:""}},[a("el-input",{directives:[{name:"wk-number",rawName:"v-wk-number",value:"positiveInt",expression:"'positiveInt'"}],staticStyle:{width:"120px"},attrs:{disabled:10!=e.optionsType,type:"text"},on:{blur:function(t){e.inputBlurValidate("score",i,"min")}},model:{value:t.minScore,callback:function(a){e.$set(t,"minScore",a)},expression:"scoreLevel.minScore"}},[a("template",{slot:"append"},[e._v("分")])],2)],1),e._v(" "),a("div",{staticClass:"range"},[e._v("~")]),e._v(" "),a("el-form-item",{attrs:{prop:"scoreLevelList["+i+"].maxScore",rules:e.getScoreRules(t,i,"max"),label:""}},[a("el-input",{directives:[{name:"wk-number",rawName:"v-wk-number",value:"positiveInt",expression:"'positiveInt'"}],staticStyle:{width:"120px"},attrs:{disabled:10!=e.optionsType,type:"text"},on:{blur:function(t){e.inputBlurValidate("score",i,"max")}},model:{value:t.maxScore,callback:function(a){e.$set(t,"maxScore",a)},expression:"scoreLevel.maxScore"}},[a("template",{slot:"append"},[e._v("分")])],2)],1)],1)],1),e._v(" "),a("div",{staticClass:"column"},[0==i?a("div",{staticClass:"label"},[e._v("人数比例范围")]):e._e(),e._v(" "),a("flexbox",[a("el-form-item",{attrs:{prop:"scoreLevelList["+i+"].minNum",rules:e.getProportionRules(t,i,"min"),label:""}},[a("el-input",{directives:[{name:"wk-number",rawName:"v-wk-number"}],staticStyle:{width:"120px"},attrs:{disabled:10!=e.optionsType,type:"text"},on:{blur:function(t){e.inputBlurValidate("num",i,"min")}},model:{value:t.minNum,callback:function(a){e.$set(t,"minNum",a)},expression:"scoreLevel.minNum"}},[a("template",{slot:"append"},[e._v("%")])],2)],1),e._v(" "),a("div",{staticClass:"range"},[e._v("~")]),e._v(" "),a("el-form-item",{attrs:{prop:"scoreLevelList["+i+"].maxNum",rules:e.getProportionRules(t,i,"max"),label:""}},[a("el-input",{directives:[{name:"wk-number",rawName:"v-wk-number"}],staticStyle:{width:"120px"},attrs:{disabled:10!=e.optionsType,type:"text"},on:{blur:function(t){e.inputBlurValidate("num",i,"max")}},model:{value:t.maxNum,callback:function(a){e.$set(t,"maxNum",a)},expression:"scoreLevel.maxNum"}},[a("template",{slot:"append"},[e._v("%")])],2)],1)],1)],1),e._v(" "),10==e.optionsType?a("i",{staticClass:"el-icon-remove",class:{"is-first":0==i},on:{click:function(t){e.deleteItemClick(e.baseForm.scoreLevelList,i)}}}):e._e()])}),e._v(" "),10==e.optionsType?a("div",{staticClass:"add-bar"},[a("el-button",{attrs:{icon:"el-icon-plus",type:"text"},on:{click:e.addScoreLevelClick}},[e._v("添加考核结果等级")])],1):e._e()],2),e._v(" "),a("el-form-item",{attrs:{rules:{required:!0,message:"请选择",trigger:["blur","change"]},prop:"range"}},[a("template",{slot:"label"},[e._v("\n            考核范围\n          ")]),e._v(" "),a("flexbox",[a("el-form-item",{attrs:{rules:e.getRangeRules(),prop:"employeeIds",label:""}},[a("wk-user-dep-select",{staticStyle:{width:"250px"},attrs:{disabled:10!=e.optionsType,"user-value":e.baseForm.employeeIds,"dep-value":e.baseForm.deptIds,props:{dataType:"hrm"},placeholder:"选择考核范围"},on:{"update:userValue":function(t){e.$set(e.baseForm,"employeeIds",t)},"update:depValue":function(t){e.$set(e.baseForm,"deptIds",t)}}})],1)],1)],2)],1)])],1)],1)},[],!1,null,"e85c85d0",null);y.options.__file="Create.vue";var w=y.exports,T=a("Jbo4"),_=a("L2JU"),C=a("a/5N"),S={name:"PerformanceIndex",components:{XrHeader:n.a,XrTableHeader:l.a,PerformanceCreateView:w,EmployeesView:o.a,WkBorderMenu:T.a},filters:{showTypeName:function(e){return{board:"卡片视图",list:"列表视图"}[e]}},data:function(){return{loading:!1,isCreate:!1,tabShowType:"list",list:[],currentPage:1,pageSize:15,pageSizes:[15,30,60,100],total:0,tabType:"5",tabLeftList:[{label:"未开始考核",name:"0",num:0},{label:"进行中考核",name:"5",num:0},{label:"已归档",name:"4",num:0}],tabRightList:[{label:"目标填写/目标确认中",name:"1",num:0},{label:"结果评定中",name:"2",num:0},{label:"结果确认中",name:"3",num:0}],stepList:["发起考核","填写目标/确认目标","评定结果","确认结果","考核归档"],rowId:null,rowStatus:null,showDview:!1,employeesViewData:{},employeesViewShow:!1,tableHeight:document.documentElement.clientHeight-295,fieldList:[{field:"appraisalName",width:120,name:"考核名称"},{field:"status",width:180,name:"当前阶段"},{field:"time",width:180,name:"考核时间"},{field:"appraisalRange",width:180,name:"考核范围"},{field:"tableName",width:120,name:"考核模板"},{field:"statistics.0",width:120,name:"考核人数"},{field:"statistics.1",width:120,name:"目标待填写"},{field:"statistics.2",width:120,name:"目标待确认"},{field:"statistics.3",width:120,name:"结果待评定"},{field:"statistics.4",width:120,name:"结果待确认"}]}},provide:function(){return{editAuth:this.editAuth}},computed:s()({},Object(_.b)(["hrm"]),{appraisalAuth:function(){return this.hrm.appraisal},createAuth:function(){return this.appraisalAuth&&this.appraisalAuth.save},deleteAuth:function(){return this.appraisalAuth&&this.appraisalAuth.delete},editAuth:function(){return this.appraisalAuth&&this.appraisalAuth.update},detailAuth:function(){return this.appraisalAuth&&this.appraisalAuth.read},stopAuth:function(){return this.appraisalAuth&&this.appraisalAuth.stop}}),watch:{},beforeRouteUpdate:function(e,t,a){e.query.tabType&&(this.tabType=e.query.tabType),this.refreshList(),a()},created:function(){this.$route.query.tabType&&(this.tabType=this.$route.query.tabType),this.refreshList()},methods:{showTypeChange:function(e){this.tabShowType=e},createClick:function(){this.rowId=null,this.isCreate=!0},createSaveSuccess:function(){this.refreshList()},refreshList:function(){this.getTabsNum(),this.handleCurrentChange(1)},handleSizeChange:function(e){this.pageSize=e,this.getList()},handleCurrentChange:function(e){this.currentPage=e,this.getList()},getTabsNum:function(){var e=this;Object(r.h)().then(function(t){var a=t.data||{};e.tabLeftList.forEach(function(e){e.num=a[parseInt(e.name)]||0}),e.tabRightList.forEach(function(e){e.num=a[parseInt(e.name)]||0})}).catch(function(){})},getList:function(){var e=this;this.loading=!0;var t={page:this.currentPage,limit:this.pageSize,pageType:1,status:this.tabType};Object(r.g)(t).then(function(t){e.list=t.data.list,e.total=t.data.totalRow,e.loading=!1}).catch(function(){e.loading=!1})},getPeriodTime:function(e){return Object(v.C)(e.startTime,"YYYY.MM.DD")+"-"+Object(v.C)(e.endTime,"YYYY.MM.DD")},getStatusHandleButtonName:function(e){return 4==e.status?"":1==e.isStop?"归档":{0:"开启考核",1:"开启评定",2:"开启结果确认",3:"归档"}[e.status]},isCanHandle:function(e,t){var a=4!=e.status;return"delete"==t?this.getIsDeleteHandle(e)?a&&this.deleteAuth:a&&this.stopAuth:a&&this.editAuth},isHandleDisabled:function(e){return 3==e.status&&0==e.isArchive},getIsDeleteHandle:function(e){return 0==e.status||4==e.status||1==e.isStop},getDeleteButtonName:function(e){return 4==e.status?"":this.getIsDeleteHandle(e)?"删除考核":"终止考核"},rowClick:function(e,t,a){if("delete"==e)this.getIsDeleteHandle(t)?this.deleteItem(t):this.stopItem(t);else if("status"==e){if(3==t.status||1==t.isStop){var i=1==t.isStop?this.getStatusMessage(t.status,t.isStop)+"，归档后不能修改，是否确认归档？":this.getStatusMessage(t.status)+"，归档后不能修改，是否确认归档？";this.updateItemStatus(i,t,"4")}else if(0==t.status)this.updateItemStatus(this.getStatusMessage(t.status)+"，开启考核后只能修改结果评定人和结果确认人，是否确认开启？",t,"1");else if(1==t.status){var s=this.getStatusMessage(t.status)+"，"+this.getStatusNumMessage(!1,t.statistics);s+="开启评定后只能修改结果确认人，是否确认开启？",this.updateItemStatus(s,t,"2")}else if(2==t.status){var r=this.getStatusMessage(t.status)+"，"+this.getStatusNumMessage(!0,t.statistics);r+="开启结果确认后将无法修改结果确认人，是否确认开启？",this.updateItemStatus(r,t,"3")}}else"check"==e&&(this.rowStatus=t.status,this.rowId=t.appraisalId,this.isCreate=!0)},fieldFormatter:function(e,t,a){return a+"人"},numCellClassName:function(e){var t=e.row;e.column,e.rowIndex;return 0==e.columnIndex&&0===t.status?"":"can-visit--underline"},itemCellStyle:function(e){var t=e.row;return 0==e.column.property?0!==t.status?{cursor:"pointer"}:{}:{cursor:"pointer"}},numRowClick:function(e,t){var a=Array.prototype.slice.call(e),i=a[1].property;0===t.status&&"0"==i||(this.employeesViewData={appraisalId:t.appraisalId,status:"0"==i?"":i},this.employeesViewShow=!0)},deleteItem:function(e){var t=this;this.$confirm("确定要删除考核?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(r.b)(e.appraisalId).then(function(e){t.$message.success("删除成功"),t.refreshList()}).catch(function(){})}).catch(function(){t.$message({type:"info",message:"已取消操作"})})},stopItem:function(e){var t=this,a=this.getStatusMessage(e.status)+"，"+this.getStatusNumMessage(!0,e.statistics);a+="是否确认终止考核？",this.$confirm(a,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(r.k)(e.appraisalId).then(function(e){t.$message.success("终止成功"),t.refreshList()}).catch(function(){})}).catch(function(){t.$message({type:"info",message:"已取消操作"})})},getStatusMessage:function(e,t){return 1===t?"当前考核已终止":{0:"当前考核未开始",1:"当前考核在目标填写/目标确认中",2:"当前考核在结果评定中",3:"当前考核在结果确认中"}[e]||""},getStatusNumMessage:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments[1]||{},a=t[1],i=t[2],s=e?t[3]:0,r="";if(a>0||i>0||e&&s>0){r+="还有";var n=[];a>0&&n.push(a+"人目标待填写"),i>0&&n.push(i+"人目标待确认"),s>0&&n.push(s+"人结果待评定"),r=r+n.join("、")+"，"}return r},updateItemStatus:function(e,t,a){var i=this;this.$confirm(""+e,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(r.l)({appraisalId:t.appraisalId,status:a}).then(function(e){i.$message.success("操作成功"),i.refreshList()}).catch(function(){})}).catch(function(){i.$message({type:"info",message:"已取消操作"})})},cellClassName:function(e){var t=e.row,a=e.column;e.rowIndex,e.columnIndex;return"statistics.0"===a.property&&0!==t.status||["appraisalName","statistics.1","statistics.2","statistics.3","statistics.4"].includes(a.property)?"can-visit--underline":""},handleRowClick:function(e,t,a){if("appraisalName"===t.property)this.rowClick("check",e,null);else if(["statistics.0","statistics.1","statistics.2","statistics.3","statistics.4"].includes(t.property)){var i=t.property.split(".")[1];this.numRowClick([null,{property:i}],e)}},tableFieldFormatter:function(e,t,a,i){if("status"===t.property){var s=1==e.isStop&&4!=e.status?"（已终止）":"";return this.stepList[a]+s||"--"}return"time"===t.property?this.getPeriodTime(e):Object(C.b)(a)?"--":a},getStepIcon:function(e,t){return t<=e.appraisalSteps?"wk wk-success":t<e.activateSteps?"wk wk-icon-datetime":t===e.activateSteps?"":4===t&&4===e.status?"wk wk-success":""}}},k=(a("jV/8"),Object(g.a)(S,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"performance-index",attrs:{id:"employee-main-container"}},[i("xr-header",{staticStyle:{padding:"0px 15px 15px 0"},attrs:{"ft-top":"0","icon-class":"wk wk-perform","icon-color":"#2362FB",label:"考核计划"}},[i("template",{slot:"ft"},[i("el-dropdown",{attrs:{trigger:"click"},on:{command:e.showTypeChange}},[i("div",{staticClass:"el-dropdown-link"},[e._v("\n          "+e._s(e._f("showTypeName")(e.tabShowType))),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{attrs:{command:"board"}},[e._v("卡片视图")]),e._v(" "),i("el-dropdown-item",{attrs:{command:"list"}},[e._v("列表视图")])],1)],1),e._v(" "),e.createAuth?i("el-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"el-icon-plus",type:"primary"},on:{click:e.createClick}},[e._v("新建考核")]):e._e()],1)],2),e._v(" "),i("div",{staticClass:"main-body"},[i("flexbox",[i("wk-border-menu",{staticStyle:{flex:"1"},attrs:{list:e.tabLeftList,"is-select":!!e.tabLeftList.find(function(t){return t.name==e.tabType})},on:{select:e.refreshList},model:{value:e.tabType,callback:function(t){e.tabType=t},expression:"tabType"}}),e._v(" "),i("wk-border-menu",{staticStyle:{flex:"1","margin-left":"20px"},attrs:{list:e.tabRightList,"is-select":!!e.tabRightList.find(function(t){return t.name==e.tabType})},on:{select:e.refreshList},model:{value:e.tabType,callback:function(t){e.tabType=t},expression:"tabType"}})],1),e._v(" "),i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"main-list"},["board"===e.tabShowType?[i("div",{directives:[{name:"empty",rawName:"v-empty",value:!e.list||0==e.list.length,expression:"!list || list.length == 0"}],staticClass:"main-list__body"},e._l(e.list,function(t,s){return i("el-card",{key:s,staticClass:"main-card"},[i("div",{staticClass:"main-card__header"},[i("span",{staticClass:"can-visit--underline",on:{click:function(a){e.rowClick("check",t,s)}}},[e._v(e._s(t.appraisalName))]),e._v(" "),i("div",{staticClass:"header-handle"},[e.detailAuth?i("el-button",{attrs:{plain:""},on:{click:function(a){e.rowClick("check",t,s)}}},[e._v("查看考核设置")]):e._e(),e._v(" "),e.isCanHandle(t,"delete")?i("el-button",{attrs:{plain:""},on:{click:function(a){e.rowClick("delete",t,s)}}},[e._v(e._s(e.getDeleteButtonName(t)))]):e._e(),e._v(" "),e.isCanHandle(t,"status")?i("el-button",{attrs:{disabled:e.isHandleDisabled(t),type:"primary"},on:{click:function(a){e.rowClick("status",t,s)}}},[e._v(e._s(e.getStatusHandleButtonName(t)))]):e._e()],1)]),e._v(" "),i("el-row",{staticStyle:{"margin-top":"8px"}},[i("el-col",{attrs:{span:9}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:[t]}},[i("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center","header-align":"center",prop:"date",label:"考核时间"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n                      "+e._s(e.getPeriodTime(a))+"\n                    ")]}}])}),e._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center","header-align":"center",prop:"appraisalRange",label:"考核范围"}}),e._v(" "),i("el-table-column",{attrs:{"show-overflow-tooltip":"",align:"center","header-align":"center",prop:"tableName",label:"考核模板"}})],1)],1),e._v(" "),i("el-col",{staticClass:"main-card__separate",attrs:{span:2}},[e._v(" ")]),e._v(" "),i("el-col",{attrs:{span:13}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:[t.statistics?Object.assign({},t.statistics,{status:t.status}):{}],"cell-style":e.itemCellStyle,align:"center","header-align":"center"},on:{"row-click":function(a){e.numRowClick(arguments,t)}}},[i("el-table-column",{attrs:{prop:"0","show-overflow-tooltip":"",align:"center","header-align":"center",label:"考核人数"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{class:{"can-visit--underline":0!==t.row.status}},[e._v(e._s(t.row[t.column.property]))]),i("span",{staticStyle:{color:"#333"}},[e._v("人")])]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"1","show-overflow-tooltip":"",align:"center","header-align":"center",label:"目标待填写"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"can-visit--underline"},[e._v(e._s(t.row[t.column.property]))]),i("span",{staticStyle:{color:"#333"}},[e._v("人")])]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"2","show-overflow-tooltip":"",align:"center","header-align":"center",label:"目标待确认"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"can-visit--underline"},[e._v(e._s(t.row[t.column.property]))]),i("span",{staticStyle:{color:"#333"}},[e._v("人")])]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"3","show-overflow-tooltip":"",align:"center","header-align":"center",label:"结果待评定"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"can-visit--underline"},[e._v(e._s(t.row[t.column.property]))]),i("span",{staticStyle:{color:"#333"}},[e._v("人")])]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"4","show-overflow-tooltip":"",align:"center","header-align":"center",label:"结果待确认"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("span",{staticClass:"can-visit--underline"},[e._v(e._s(t.row[t.column.property]))]),i("span",{staticStyle:{color:"#333"}},[e._v("人")])]}}])})],1)],1)],1),e._v(" "),i("el-steps",{attrs:{space:200,active:1==t.isStop||4==t.status?null:t.status}},e._l(e.stepList,function(a,s){return i("el-step",{key:s,attrs:{title:a,icon:e.getStepIcon(t,s)}})})),e._v(" "),4===t.status?i("img",{staticClass:"main-card__stop",attrs:{width:"120px",src:a("WBVl")}}):1===t.isStop?i("img",{staticClass:"main-card__stop",attrs:{width:"120px",src:a("+WIx")}}):e._e()],1)}))]:i("div",{staticClass:"main-list__body"},[i("el-table",{staticClass:"n-table--border el-table-header--white",staticStyle:{width:"100%"},attrs:{id:"crm-table","row-height":40,data:e.list,height:e.tableHeight,"cell-class-name":e.cellClassName,"use-virtual":"",stripe:"",border:"","highlight-current-row":""},on:{"row-click":e.handleRowClick}},[e._l(e.fieldList,function(t,a){return i("el-table-column",{key:a,attrs:{fixed:0==a,prop:t.field,label:t.name,"min-width":t.width,formatter:e.tableFieldFormatter,"show-overflow-tooltip":""}})}),e._v(" "),i("el-table-column"),e._v(" "),i("el-table-column",{attrs:{label:"操作",fixed:"right",width:"350"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row,s=t.$index;return[e.detailAuth?i("el-button",{attrs:{plain:""},on:{click:function(t){e.rowClick("check",a,s)}}},[e._v("查看考核设置")]):e._e(),e._v(" "),e.isCanHandle(a,"delete")?i("el-button",{attrs:{plain:""},on:{click:function(t){e.rowClick("delete",a,s)}}},[e._v(e._s(e.getDeleteButtonName(a)))]):e._e(),e._v(" "),e.isCanHandle(a,"status")?i("el-button",{attrs:{disabled:e.isHandleDisabled(a),type:"primary"},on:{click:function(t){e.rowClick("status",a,s)}}},[e._v(e._s(e.getStatusHandleButtonName(a)))]):e._e()]}}])})],2)],1)],2),e._v(" "),i("div",{staticClass:"p-contianer"},[i("el-pagination",{staticClass:"p-bar",attrs:{"current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.pageSize,total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:pageSize":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),e.isCreate?i("performance-create-view",{attrs:{id:e.rowId,status:e.rowStatus},on:{success:e.createSaveSuccess,close:function(t){e.isCreate=!1}}}):e._e(),e._v(" "),i("employees-view",{attrs:{visible:e.employeesViewShow,id:e.employeesViewData.appraisalId,status:e.employeesViewData.status},on:{"update:visible":function(t){e.employeesViewShow=t}}})],1)},[],!1,null,"3ce452f5",null));k.options.__file="index.vue";t.default=k.exports},cZXy:function(e,t,a){"use strict";a.d(t,"g",function(){return s}),a.d(t,"h",function(){return r}),a.d(t,"a",function(){return n}),a.d(t,"j",function(){return l}),a.d(t,"l",function(){return o}),a.d(t,"b",function(){return u}),a.d(t,"k",function(){return c}),a.d(t,"c",function(){return p}),a.d(t,"i",function(){return d}),a.d(t,"d",function(){return m}),a.d(t,"e",function(){return f}),a.d(t,"f",function(){return h});var i=a("t3Un");function s(e){return Object(i.a)({url:"hrmAchievementAppraisal/queryAppraisalPageList",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function r(e){return Object(i.a)({url:"hrmAchievementAppraisal/queryAppraisalStatusNum",method:"post",data:e})}function n(e){return Object(i.a)({url:"hrmAchievementAppraisal/addAppraisal",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function l(e){return Object(i.a)({url:"hrmAchievementAppraisal/setAppraisal",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function o(e){return Object(i.a)({url:"hrmAchievementAppraisal/updateAppraisalStatus",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function u(e){return Object(i.a)({url:"hrmAchievementAppraisal/delete/"+e,method:"post"})}function c(e){return Object(i.a)({url:"hrmAchievementAppraisal/stopAppraisal/"+e,method:"post"})}function p(e){return Object(i.a)({url:"hrmAchievementAppraisal/queryAppraisalById/"+e,method:"post"})}function d(e){return Object(i.a)({url:"hrmAchievementAppraisal/queryAppraisalEmployeeList",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function m(e){return Object(i.a)({url:"hrmAchievementAppraisal/queryEmployeeAppraisalCount/"+e,method:"post"})}function f(e){return Object(i.a)({url:"hrmAchievementAppraisal/queryEmployeeAppraisal",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function h(e){return Object(i.a)({url:"hrmAchievementAppraisal/queryEmployeeListByAppraisalId",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}},fUY0:function(e,t,a){"use strict";var i=a("7ZQD");a.n(i).a},"ixM/":function(e,t,a){"use strict";a.d(t,"c",function(){return u}),a.d(t,"g",function(){return c}),a.d(t,"a",function(){return p}),a.d(t,"f",function(){return d}),a.d(t,"d",function(){return m}),a.d(t,"e",function(){return f}),a.d(t,"b",function(){return h});var i=a("GQeE"),s=a.n(i),r=a("7Qib"),n=a("a/5N"),l=a("cHj4"),o=a("D0zU");var u={fields:[{name:"学历",field:"education",formType:"select",setting:[{label:"小学",value:1},{label:"初中",value:2},{label:"中专",value:3},{label:"中职",value:4},{label:"中技",value:5},{label:"高中",value:6},{label:"大专",value:7},{label:"本科",value:8},{label:"硕士",value:9},{label:"博士",value:10},{label:"博士后",value:11},{label:"其他",value:12}]},{name:"毕业院校",field:"graduateSchool",formType:"text",setting:[]},{name:"专业",field:"major",formType:"text",setting:[]},{name:"入学时间",field:"admissionTime",formType:"date",setting:[]},{name:"毕业时间",field:"graduationTime",formType:"date",setting:[]},{name:"教学方式",field:"teachingMethods",formType:"select",setting:[{label:"全日制",value:1},{label:"成人教育",value:2},{label:"远程教育",value:3},{label:"自学考试",value:4},{label:"其他",value:5}]},{name:"是否第一学历",field:"isFirstDegree",formType:"radio",setting:[{label:"否",value:0},{label:"是",value:1}]}],rules:{education:[{required:!0,message:"请选择",trigger:["blur","change"]}],graduateSchool:[{required:!0,message:"请输入",trigger:["blur","change"]}],major:[{required:!0,message:"请输入",trigger:["blur","change"]}],isFirstDegree:[{required:!0,message:"请选择",trigger:["blur","change"]}]},educationValue:{1:"小学",2:"初中",3:"中专",4:"中职",5:"中技",6:"高中",7:"大专",8:"本科",9:"硕士",10:"博士",11:"博士后",12:"其他"},teachingMethodsValue:{1:"全日制",2:"成人教育",3:"远程教育",4:"自学考试",5:"其他"},isFirstDegreeValue:{1:"是",0:"否"}},c={fields:[{name:"工作单位",field:"workUnit",formType:"text",setting:[]},{name:"职务",field:"post",formType:"text",setting:[]},{name:"工作开始时间",field:"workStartTime",formType:"date",setting:[]},{name:"工作结束时间",field:"workEndTime",formType:"date",setting:[]},{name:"离职原因",field:"leavingReason",formType:"text",setting:[]},{name:"证明人",field:"witness",formType:"text",setting:[]},{name:"证明人电话",field:"witnessPhone",formType:"mobile",setting:[]},{name:"工作备注",field:"workRemarks",formType:"text",setting:[]}],rules:{workUnit:[{required:!0,message:"请输入",trigger:["blur","change"]}],post:[{required:!0,message:"请输入",trigger:["blur","change"]}],witnessPhone:[{validator:function(e,t,a){Object(n.b)(t)||Object(r.y)(t)?a():a(new Error("手机格式有误"))},trigger:["blur","change"]}]}},p={fields:[{name:"证书名称",field:"certificateName",formType:"text",setting:[]},{name:"证书级别",field:"certificateLevel",formType:"text",setting:[]},{name:"证书/证件编号",field:"certificateNum",formType:"text",setting:[]},{name:"有效期起始日期",field:"startTime",formType:"date",setting:[]},{name:"有效期到期日",field:"endTime",formType:"date",setting:[]},{name:"发证机构",field:"issuingAuthority",formType:"text",setting:[]},{name:"发证日期",field:"issuingTime",formType:"date",setting:[]},{name:"证件备注",field:"remarks",formType:"text",setting:[]}],rules:{certificateName:[{required:!0,message:"请输入",trigger:["blur","change"]}]}},d={fields:[{name:"培训课程",field:"trainingCourse",formType:"text",setting:[]},{name:"培训机构名称",field:"trainingOrganName",formType:"text",setting:[]},{name:"培训开始时间",field:"startTime",formType:"date",setting:[]},{name:"培训结束时间",field:"endTime",formType:"date",setting:[]},{name:"培训时长",field:"trainingDuration",formType:"number",setting:[]},{name:"培训成绩",field:"trainingResults",formType:"text",setting:[]},{name:"培训证书名称",field:"trainingCertificateName",formType:"text",setting:[]},{name:"培训备注",field:"remarks",formType:"textarea",setting:[]}],rules:{trainingCourse:[{required:!0,message:"请输入",trigger:["blur","change"]}]}},m={sexValue:{1:"男",2:"女"},birthdayTypeValue:{1:"阳历",2:"农历"},idTypeValue:{1:"身份证",2:"港澳通行证",3:"台湾通行证",4:"护照",5:"其他"},employmentFormsValue:{1:"正式",2:"非正式"},probationValue:{0:"无试用期",1:"1个月",2:"2个月",3:"3个月",4:"4个月",5:"5个月",6:"6个月"},statusValue:{1:"正式",2:"试用",3:"实习",4:"兼职",5:"劳务",6:"顾问",7:"返聘",8:"外包",11:"在职",12:"全职",13:"待入职",14:"待离职",15:"已离职"},validStatusValue:{1:"正式",2:"试用",3:"实习",4:"兼职",5:"劳务",6:"顾问",7:"返聘",8:"外包"},getValueList:function(e){return s()(e).map(function(t){return{label:e[t],value:parseInt(t)}})},sexSetting:[{label:"男",value:1},{label:"女",value:2}],idTypeSetting:[{label:"身份证",value:1},{label:"港澳通行证",value:2},{label:"台湾通行证",value:3},{label:"护照",value:4},{label:"其他",value:5}],employmentFormsSetting:[{label:"正式",value:1},{label:"非正式",value:2}],probationSetting:[{label:"无试用期",value:0},{label:"1个月",value:1},{label:"2个月",value:2},{label:"3个月",value:3},{label:"4个月",value:4},{label:"5个月",value:5},{label:"6个月",value:6}],statusSetting:[{label:"实习",value:3},{label:"兼职",value:4},{label:"劳务",value:5},{label:"顾问",value:6},{label:"返聘",value:7},{label:"外包",value:8}]},f={fields:[{name:"部门",field:"newDept",formType:"structure",props:{dataType:"hrm"},request:o.e,setting:[]},{name:"岗位",field:"newPost",formType:"text",setting:[]},{name:"直属上级",field:"newParentId",formType:"user",props:{label:"employeeName",value:"employeeId"},request:l.i,setting:[]},{name:"计划转正日期",field:"becomeTime",formType:"text",disabled:!0,setting:[]},{name:"实际转正日期",field:"effectTime",formType:"date",setting:[]},{name:"备注",field:"remarks",formType:"textarea",setting:[]}],rules:{effectTime:[{required:!0,message:"请选择",trigger:["blur","change"]}]}};var h={fieldsFunc:function(e,t){var a=[{label:"调岗",value:5},{label:"晋升",value:6},{label:"降级",value:7}];3!=t&&4!=t||a.push({label:"转为全职员工",value:8});var i=[{name:"异动类型",field:"changeType",formType:"select",setting:a},{name:"异动原因",field:"changeReason",formType:"select",setting:7==e?[{label:"违规违纪",value:4},{label:"绩效不达标",value:5},{label:"个人身体原因",value:6},{label:"不适应当前岗位",value:7}]:[{label:"组织架构调整",value:1},{label:"个人申请",value:2},{label:"工作安排",value:3}]}];return 8==e&&(i=i.concat([{name:"入职日期",field:"entryTime",formType:"date",disabled:!0,setting:[]},{name:"试用期",field:"probation",formType:"select",setting:[{label:"无试用期",value:0},{label:"1个月",value:1},{label:"2个月",value:2},{label:"3个月",value:3},{label:"4个月",value:4},{label:"5个月",value:5},{label:"6个月",value:6}]}])),i.concat([{name:"原部门",field:"oldDept",formType:"structure",disabled:!0,props:{dataType:"hrm"},request:o.e,setting:[]},{name:"变更为",field:"newDept",formType:"structure",props:{dataType:"hrm"},request:o.e,setting:[]},{name:"原岗位",field:"oldPost",formType:"text",disabled:!0,setting:[]},{name:"变更为",field:"newPost",formType:"text",setting:[]},{name:"原岗位职级",field:"oldPostLevel",disabled:!0,formType:"text",setting:[]},{name:"变更为",field:"newPostLevel",formType:"text",setting:[]},{name:"原工作地点",field:"oldWorkAddress",formType:"text",disabled:!0,setting:[]},{name:"变更为",field:"newWorkAddress",formType:"text",setting:[]},{name:"生效日期",field:"effectTime",formType:"date",setting:[]},{name:"备注",field:"remarks",formType:"textarea",setting:[]}])},rules:{effectTime:[{required:!0,message:"请选择",trigger:["blur","change"]}]}}},"jV/8":function(e,t,a){"use strict";var i=a("unNo");a.n(i).a},kLfe:function(e,t,a){},"lH/j":function(e,t,a){"use strict";var i=a("GQeE"),s=a.n(i),r=a("cZXy"),n=a("9I6p"),l=a("D0zU"),o=a("kBEL"),u=a("wQsH"),c=a("a/5N"),p=a("ixM/"),d=a("Gbek"),m={name:"EmployeesView",components:{WkPopoverFilter:o.a,EmployeeConfirmPerformance:u.a},mixins:[],props:{status:[String,Number],id:[String,Number],visible:{type:Boolean,required:!0,default:!1}},data:function(){return{loading:!1,filterObj:{},tableHeight:this.getTableHeight(),list:[],fieldList:[{fieldName:"employeeName",name:"姓名",width:130},{fieldName:"mobile",name:"手机号",width:80},{fieldName:"jobNumber",name:"工号",width:80},{fieldName:"deptName",name:"部门",width:80},{fieldName:"employeeStatus",name:"员工状态",width:80},{fieldName:"status",name:"考核状态",width:80},{fieldName:"followUpEmployeeName",name:"跟进人",width:80},{fieldName:"score",name:"评分",width:80},{fieldName:"levelName",name:"考核结果",width:120}],currentPage:1,pageSize:15,pageSizes:[15,30,60,100],total:0,rowId:"",detailShow:!1,levelOptions:[]}},computed:{filterList:function(){return[{name:"姓名",field:"employeeName",formType:"text",setting:[]},{name:"部门",field:"deptId",formType:"structure",props:{dataType:"hrm"},request:l.e,setting:[]},{name:"等级",field:"levelId",formType:"select",setting:this.levelOptions},{name:"考核状态",field:"status",formType:"select",setting:d.a.getValueList(d.a.statusValue)}]},hasFilterContent:function(){if(this.filterObj){for(var e=!1,t=s()(this.filterObj),a=0;a<t.length;a++){var i=t[a];""!=this.filterObj[i]&&this.filterObj[i]!=[]&&null!=this.filterObj[i]&&void 0!=this.filterObj[i]&&(e=!0)}return e}return!1}},watch:{visible:{handler:function(e){e&&(this.filterObj={status:Object(c.b)(this.status)||isNaN(this.status)?"":parseInt(this.status)},0==this.levelOptions.length&&this.getLevelList(),this.refreshList())},immediate:!0}},mounted:function(){},methods:{refreshList:function(){this.handleCurrentChange(1)},resetFilter:function(){this.filterObj={},this.refreshList()},handleSizeChange:function(e){this.pageSize=e,this.getList()},handleCurrentChange:function(e){this.currentPage=e,this.getList()},getList:function(){var e=this;this.loading=!0;var t={page:this.currentPage,limit:this.pageSize,status:this.status,appraisalId:this.id};for(var a in this.filterObj)t[a]=this.filterObj[a];Object(r.f)(t).then(function(t){e.list=t.data.list,e.total=t.data.totalRow,e.loading=!1}).catch(function(){e.loading=!1})},getTableHeight:function(){var e=document.documentElement.clientHeight;return e-.2*e-200},fieldFormatter:function(e,t){if("employeeStatus"==t.property)return p.d.statusValue[e.employeeStatus]||"--";if("status"==t.property)return d.a.statusValue[e.status]||"--";var a=e[t.property];return Object(c.b)(a)?"--":a},handleRowClick:function(e,t,a){"employeeName"==t.property&&(this.rowId=e.employeeAppraisalId,this.detailShow=!0)},handleCancel:function(){this.detailShow=!1,this.$emit("update:visible",!1)},getLevelList:function(){var e=this;Object(n.f)(this.id).then(function(t){var a=t.data||[];a.forEach(function(e){e.label=e.levelName,e.value=e.levelId}),e.levelOptions=a}).catch(function(){})}}},f=(a("97R0"),a("KHd+")),h=Object(f.a)(m,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{visible:e.visible,"append-to-body":!0,"close-on-click-modal":!1,title:"详情",top:"10vh",width:"80%"},on:{close:e.handleCancel}},[a("div",{staticClass:"filter-div"},[e.hasFilterContent?a("el-button",{attrs:{type:"text"},on:{click:e.resetFilter}},[e._v("清除筛选")]):e._e(),e._v(" "),a("wk-popover-filter",{staticStyle:{"margin-right":"5px"},attrs:{"field-from":e.filterObj,"field-list":e.filterList,"has-content":e.hasFilterContent,width:"80%",placement:"bottom"},on:{"update:fieldFrom":function(t){e.filterObj=t},sure:e.refreshList,reset:e.resetFilter}})],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"n-table--border el-table-header--white",staticStyle:{width:"100%"},attrs:{id:"crm-table","row-height":40,data:e.list,height:e.tableHeight,"use-virtual":"",stripe:"",border:"","highlight-current-row":""},on:{"row-click":e.handleRowClick}},[a("el-table-column",{attrs:{prop:"index",label:"序号",width:"80","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.$index+1)+"\n      ")]}}])}),e._v(" "),e._l(e.fieldList,function(t,i){return a("el-table-column",{key:i,attrs:{prop:t.fieldName,label:t.name,"min-width":t.width,"show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return["employeeName"===t.column.property?[a("span",{staticClass:"can-visit--underline"},[e._v(e._s(e.fieldFormatter(t.row,t.column)))]),1==t.row.isDel?a("span",{staticStyle:{color:"#999"}},[e._v("（已删除）")]):e._e()]:[e._v("\n          "+e._s(e.fieldFormatter(t.row,t.column))+"\n        ")]]}}])})})],2),e._v(" "),a("div",{staticClass:"p-contianer"},[a("el-pagination",{staticClass:"p-bar",attrs:{"current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.pageSize,total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:pageSize":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),e.detailShow?a("employee-confirm-performance",{attrs:{id:e.rowId,"handle-type":"evaluato-view"},on:{close:function(t){e.detailShow=!1}}}):e._e()],1)},[],!1,null,"77a4fe5c",null);h.options.__file="EmployeesView.vue";t.a=h.exports},unNo:function(e,t,a){},wRyu:function(e,t,a){},zMw6:function(e,t,a){"use strict";a.d(t,"j",function(){return s}),a.d(t,"m",function(){return r}),a.d(t,"c",function(){return n}),a.d(t,"i",function(){return l}),a.d(t,"h",function(){return o}),a.d(t,"l",function(){return u}),a.d(t,"k",function(){return c}),a.d(t,"n",function(){return p}),a.d(t,"g",function(){return d}),a.d(t,"f",function(){return m}),a.d(t,"o",function(){return f}),a.d(t,"d",function(){return h}),a.d(t,"e",function(){return v}),a.d(t,"a",function(){return b}),a.d(t,"b",function(){return g}),a.d(t,"u",function(){return y}),a.d(t,"w",function(){return w}),a.d(t,"x",function(){return T}),a.d(t,"v",function(){return _}),a.d(t,"A",function(){return C}),a.d(t,"B",function(){return S}),a.d(t,"y",function(){return k}),a.d(t,"z",function(){return x}),a.d(t,"p",function(){return L}),a.d(t,"q",function(){return F}),a.d(t,"r",function(){return j}),a.d(t,"s",function(){return I}),a.d(t,"t",function(){return N});var i=a("t3Un");function s(e){return Object(i.a)({url:"hrmConfig/queryRecruitChannelList",method:"post",data:e})}function r(e){return Object(i.a)({url:"hrmConfig/saveRecruitChannel",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function n(e){return Object(i.a)({url:"hrmConfig/deleteRecruitChannel",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function l(e){return Object(i.a)({url:"hrmConfig/queryFields",method:"post",data:e})}function o(e){return Object(i.a)({url:"hrmConfig/queryFieldByLabel/"+e,method:"post"})}function u(e){return Object(i.a)({url:"hrmConfig/saveField",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function c(e){return Object(i.a)({url:"hrmConfig/queryRecruitEliminateList",method:"post",data:e})}function p(e){return Object(i.a)({url:"hrmConfig/saveRecruitEliminate",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function d(e){return Object(i.a)({url:"hrmConfig/queryAchievementTableList",method:"post",data:e})}function m(e){return Object(i.a)({url:"hrmConfig/queryAchievementTableById/"+e,method:"post"})}function f(e){return Object(i.a)({url:"hrmConfig/setAchievementTable",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function h(e){return Object(i.a)({url:"hrmConfig/queryInsuranceSchemePageList",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function v(e){return Object(i.a)({url:"hrmConfig/queryInsuranceSchemeById/"+e,method:"post"})}function b(e){return Object(i.a)({url:"hrmConfig/addInsuranceScheme",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function g(e){return Object(i.a)({url:"hrmConfig/deleteInsuranceScheme/"+e,method:"post"})}function y(e){return Object(i.a)({url:"hrmSalaryGroup/addSalaryGroup",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function w(e){return Object(i.a)({url:"hrmSalaryGroup/querySalaryGroupPageList",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function T(e){return Object(i.a)({url:"hrmSalaryGroup/setSalaryGroup",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function _(e){return Object(i.a)({url:"hrmSalaryGroup/delete/"+e,method:"post"})}function C(e){return Object(i.a)({url:"hrmSalaryTaxRule/queryTaxRuleList",method:"post",data:e})}function S(e){return Object(i.a)({url:"hrmSalaryTaxRule/setTaxRule",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function k(e){return Object(i.a)({url:"hrmSalaryOption/querySalaryOptionDetail",method:"post",data:e})}function x(e){return Object(i.a)({url:"hrmSalaryOption/setSalaryOption",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function L(){return Object(i.a)({url:"hrmEmployeeArchives/queryEmployeeArchivesField",method:"post"})}function F(e){return Object(i.a)({url:"hrmEmployeeArchives/sendWriteArchives",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function j(e){return Object(i.a)({url:"hrmEmployeeArchives/setEmployeeArchivesField",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function I(e){return Object(i.a)({url:"hrmEmployeeFieldManage/queryEmployeeManageField",method:"post",data:e})}function N(e){return Object(i.a)({url:"hrmEmployeeFieldManage/setEmployeeManageField",method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}}}]);