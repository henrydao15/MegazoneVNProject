(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-1306"],{"/Zkf":function(e,t,i){},"1bEW":function(e,t,i){"use strict";var a=i("H3Hc");i.n(a).a},"2pLh":function(e,t,i){"use strict";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function a(){for(var e=0,t=0,i=arguments.length;t<i;t++)e+=arguments[t].length;var a=Array(e),n=0;for(t=0;t<i;t++)for(var s=arguments[t],l=0,o=s.length;l<o;l++,n++)a[n]=s[l];return a}function n(e,t){return void 0===t&&(t=15),+parseFloat(Number(e).toPrecision(t))}function s(e){var t=e.toString().split(/[eE]/),i=(t[0].split(".")[1]||"").length-+(t[1]||0);return i>0?i:0}function l(e){if(-1===e.toString().indexOf("e"))return Number(e.toString().replace(".",""));var t=s(e);return t>0?n(Number(e)*Math.pow(10,t)):Number(e)}function o(e){d&&(e>Number.MAX_SAFE_INTEGER||Number.MIN_SAFE_INTEGER)}function r(e,t){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];if(i.length>0)return r.apply(void 0,a([r(e,t),i[0]],i.slice(1)));var c=l(e),d=l(t),u=s(e)+s(t),h=c*d;return o(h),h/Math.pow(10,u)}function c(e,t){for(var i=[],d=2;d<arguments.length;d++)i[d-2]=arguments[d];if(i.length>0)return c.apply(void 0,a([c(e,t),i[0]],i.slice(1)));var u=l(e),h=l(t);return o(u),o(h),r(u/h,n(Math.pow(10,s(t)-s(e))))}var d=!0;var u={strip:n,plus:function e(t,i){for(var n=[],l=2;l<arguments.length;l++)n[l-2]=arguments[l];if(n.length>0)return e.apply(void 0,a([e(t,i),n[0]],n.slice(1)));var o=Math.pow(10,Math.max(s(t),s(i)));return(r(t,o)+r(i,o))/o},minus:function e(t,i){for(var n=[],l=2;l<arguments.length;l++)n[l-2]=arguments[l];if(n.length>0)return e.apply(void 0,a([e(t,i),n[0]],n.slice(1)));var o=Math.pow(10,Math.max(s(t),s(i)));return(r(t,o)-r(i,o))/o},times:r,divide:c,round:function(e,t){var i=Math.pow(10,t);return c(Math.round(r(e,i)),i)},digitLength:s,float2Fixed:l,enableBoundaryChecking:function(e){void 0===e&&(e=!0),d=e}};t.a=u},"8dia":function(e,t,i){"use strict";var a=i("CKev");i.n(a).a},BCQY:function(e,t,i){"use strict";i.r(t);var a=i("GQeE"),n=i.n(a),s=i("QbLZ"),l=i.n(s),o=i("9I6p"),r=i("9GgJ"),c=i("jpO5"),d=i("kBEL"),u=i("L2JU"),h=i("a/5N"),m=i("Gbek"),f=i("4d7F"),p=i.n(f),v=i("WfJ5"),g={name:"WeightEditDialog",components:{},mixins:[],props:{surplusWeight:[String,Number],visible:{type:Boolean,required:!0,default:!1}},data:function(){return{form:{}}},computed:{},watch:{visible:{handler:function(e){e&&(this.form={weight:void 0})},immediate:!0}},mounted:function(){},methods:{handleCancel:function(){this.$emit("update:visible",!1)},handleConfirm:function(){var e=this;void 0===this.form.weight||""===this.form.weight||null===this.form.weight||this.form.weight<0||this.form.weight>100?this.$message.error("范围在0-100之间"):this.surplusWeight<this.form.weight?this.$message.error("考核项权重累加，需等于100%"):this.$refs.weightForm.validate(function(t){t&&(e.$emit("change",e.form.weight),e.handleCancel())})}}},b=(i("8dia"),i("KHd+")),w=Object(b.a)(g,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{attrs:{visible:e.visible,"append-to-body":!0,"close-on-click-modal":!1,title:"编辑权重",width:"400px"},on:{close:e.handleCancel}},[i("div",{staticClass:"form-add-dialog-body"},[i("el-form",{ref:"weightForm",attrs:{model:e.form,"label-width":"80px"},nativeOn:{submit:function(e){e.preventDefault()}}},[i("el-form-item",{attrs:{label:"权重"}},[i("el-input-number",{staticStyle:{"margin-right":"8px"},attrs:{controls:!1,min:0,max:100},model:{value:e.form.weight,callback:function(t){e.$set(e.form,"weight",t)},expression:"form.weight"}}),e._v("%\n      ")],1)],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{nativeOn:{click:function(t){return e.handleCancel(t)}}},[e._v("取消")]),e._v(" "),i("el-button",{directives:[{name:"debounce",rawName:"v-debounce",value:e.handleConfirm,expression:"handleConfirm"}],attrs:{type:"primary"}},[e._v("保存")])],1)])},[],!1,null,"9fa593e6",null);w.options.__file="WeightEditDialog.vue";var y=w.exports,_=i("3c4F"),S=i("jzeO"),x=i("7Qib"),C=i("2pLh"),k={name:"EmployeeEditPerformance",components:{PerformanceHistory:v.a,WeightEditDialog:y,ScheduleEditDialog:_.a,Reminder:S.a},props:{handleType:String,id:[String,Number]},data:function(){return{loading:!1,zIndex:Object(x.q)(),detailData:null,form:null,weightEditShow:!1,scheduleEditShow:!1,dialogEditData:{}}},computed:{editScheduleShow:function(){return this.detailData&&1!=this.detailData.status&&2!=this.detailData.status},canEditSchedule:function(){return"schedule"==this.handleType&&this.detailData&&3==this.detailData.status&&(1==this.detailData.appraisalStatus||2==this.detailData.appraisalStatus)},saveDraftShow:function(){return this.detailData&&1==this.detailData.status},title:function(){return"绩效目标"}},watch:{id:{handler:function(e){e&&(this.detailData=null,this.form=null,this.getDetail())},immediate:!0}},mounted:function(){},methods:{getDetail:function(){var e=this;this.loading=!0,Object(o.c)(this.id).then(function(t){var i=t.data||{};e.detailData=Object(x.w)(i);var a={},n=i.tableTemp;a.description=n.description,a.isEmpWeight=n.isEmpWeight,i.fixedSegList?a.fixedSegList=i.fixedSegList:a.fixedSegList=n.fixedSegListTemp||[],i.noFixedSegList?(i.noFixedSegList.forEach(function(e){e.isDefault=!!e.tempSegId,e.items.forEach(function(e){e.isDefault=!!e.tempItemId})}),a.noFixedSegList=i.noFixedSegList):(n.noFixedSegListTemp.forEach(function(e){e.isDefault=!0,e.items.forEach(function(e){e.isDefault=!0})}),a.noFixedSegList=n.noFixedSegListTemp||[]),e.form=a,e.loading=!1}).catch(function(){e.loading=!1,e.hideView()})},bigAddClick:function(e){var t=Object(x.w)(this.detailData).tableTemp;t.noFixedSegListTemp.forEach(function(e){e.isDefault=!1,e.items.forEach(function(e){e.isDefault=!0})}),e.push(t.noFixedSegListTemp[0])},subAddClick:function(e){e.push({itemName:""})},itemDeleteClick:function(e,t){e.splice(t,1)},itemHandleClick:function(e,t,i,a,n){if(this.dialogEditData={type:e,dataType:t,item:i,index:a},"weight"==e){var s=0;n.forEach(function(e,t){t!==a&&(s=C.a.plus(s,Object(h.b)(e.weight)?0:e.weight))});var l=C.a.minus(100,s);this.dialogEditData.surplusWeight=l<0?0:l,this.weightEditShow=!0}else"schedule"==e&&(this.scheduleEditShow=!0)},weightChange:function(e){"weight"==this.dialogEditData.type&&(this.dialogEditData.item.weight=e)},scheduleChange:function(e){"schedule"==this.dialogEditData.type&&(this.dialogEditData.item.schedule=e,this.$refs.performanceHistory.getDetail())},submitClick:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t?this.submiteData(t):this.validData().then(function(){e.submiteData(t)}).catch(function(){})},validData:function(){var e=this;return new p.a(function(t,i){e.$refs.form.validate(function(a){if(!a)return e.$message.error("请完善考核内容"),!1;if(1==e.form.isEmpWeight){var n=0,s=!0;if(e.form.noFixedSegList.forEach(function(e){null!=e.weight&&void 0!=e.weight&&""!=e.weight||(s=!1),n=Object(x.i)(n,e.weight)}),s&&e.form.fixedSegList.forEach(function(e){null!=e.weight&&void 0!=e.weight&&""!=e.weight||(s=!1),n=Object(x.i)(n,e.weight)}),!s)return e.$message.error("请输入考核项权重"),void i();if(100!=n)return e.$message.error("考核项权重累加，需等于100%"),void i()}2==e.detailData.status?e.$confirm("确定重新提交吗？提交后需要目标确认人重新确认","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t()}).catch(function(){e.$message({type:"info",message:"已取消操作"})}):t()})})},submiteData:function(e){var t=this,i=Object(x.w)(this.form),a={employeeAppraisalId:this.id,isDraft:e?1:0};i.noFixedSegList.forEach(function(e){e.isDefault&&(e.tempSegId=e.segId),e.items.forEach(function(e){e.isDefault&&(e.tempItemId=e.itemId)})}),a.segList=i.noFixedSegList.concat(i.fixedSegList),this.loading=!0,Object(o.q)(a).then(function(i){t.$message.success(e?"保存草稿成功":"保存成功"),t.$emit("change"),t.closeClick(),t.loading=!1}).catch(function(){t.loading=!1})},closeClick:function(){this.$emit("close")}}},T=(i("1bEW"),Object(b.a)(k,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("transition",{attrs:{name:"opacity-fade"}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"eep",style:{"z-index":e.zIndex}},[e.form?i("el-card",{staticClass:"eep-con"},[i("div",{staticClass:"eep-header"},[e._v("\n        "+e._s(e.title)+"\n        "),i("div",{staticClass:"eep-header__ft"},[i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitClick(!1)}}},[e._v("提交")]),e._v(" "),e.saveDraftShow?i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitClick(!0)}}},[e._v("保存草稿")]):e._e(),e._v(" "),i("el-button",{on:{click:e.closeClick}},[e._v("关闭")])],1)]),e._v(" "),i("div",{staticClass:"eep-body"},[i("el-form",{ref:"form",staticClass:"eep-left",attrs:{model:e.form,"validate-on-rule-change":!1,"hide-required-asterisk":""}},[i("reminder",{staticClass:"xr-reminder",attrs:{content:e.form.description}}),e._v(" "),e._l(e.form.fixedSegList,function(t,a){return i("div",{key:a,staticClass:"content-section"},[i("div",{staticClass:"section__handle"},[e.editScheduleShow?i("el-button",{attrs:{disabled:!e.canEditSchedule,type:"text",icon:"wk wk-edit"},on:{click:function(i){e.itemHandleClick("schedule","fixed",t,a,e.form.fixedSegList)}}},[e._v("\n                "+e._s(null!==t.schedule&&""!==t.schedule||!e.canEditSchedule?"进度"+(t.schedule||0)+"%":"添加进度"))]):e._e(),e._v(" "),i("el-button",{attrs:{type:"text",disabled:""}},[e._v("\n                "+e._s("权重"+(t.weight||0)+"%")+"\n              ")])],1),e._v(" "),i("div",{staticClass:"item-section"},[i("div",{staticClass:"el-row"},[e._v("\n                "+e._s(t.segName)+"\n              ")]),e._v(" "),i("div",e._l(t.items,function(t,a){return i("div",{key:a,staticClass:"el-row",staticStyle:{"padding-left":"140px"}},[i("div",{staticClass:"sub-input-value"},[e._v(e._s(t.itemName))])])}))])])}),e._v(" "),e._l(e.form.noFixedSegList,function(t,a){return i("div",{key:"no-fix-"+a,staticClass:"section"},[i("div",{staticClass:"section__handle"},[e.editScheduleShow?i("el-button",{attrs:{disabled:!e.canEditSchedule,type:"text",icon:"wk wk-edit"},on:{click:function(i){e.itemHandleClick("schedule","noFixed",t,a,e.form.noFixedSegList)}}},[e._v("\n                "+e._s(null!==t.schedule&&""!==t.schedule||!e.canEditSchedule?"进度"+t.schedule+"%":"添加进度"))]):e._e(),e._v(" "),i("el-button",{attrs:{disabled:1!=e.form.isEmpWeight,type:"text",icon:"wk wk-edit"},on:{click:function(i){e.itemHandleClick("weight","noFixed",t,a,e.form.noFixedSegList)}}},[e._v("\n                "+e._s(null===t.weight||""===t.weight?"添加权重":"权重"+t.weight+"%")+"\n              ")])],1),e._v(" "),i("div",{staticClass:"item-section"},[i("el-row",{staticClass:"item-row",attrs:{type:"flex"}},[i("el-col",{attrs:{span:23}},[i("flexbox",[i("el-form-item",{staticClass:"div-label",attrs:{prop:"noFixedSegList["+a+"].segName",rules:{required:!0,message:"请输入",trigger:"change"},label:""}},[t.isDefault?i("el-tooltip",{attrs:{content:t.segName,placement:"top"}},[i("div",[e._v(e._s(t.segName))])]):i("el-input",{attrs:{maxlength:50,resize:"none",placeholder:"标题",rows:"2",type:"textarea"},model:{value:t.segName,callback:function(i){e.$set(t,"segName",i)},expression:"noFixItem.segName"}})],1),e._v(" "),i("el-form-item",{staticClass:"div-body",staticStyle:{"margin-left":"-1px"},attrs:{prop:"noFixedSegList["+a+"].value",rules:{required:!0,message:"请输入",trigger:"change"},label:""}},[i("el-input",{attrs:{maxlength:200,resize:"none",placeholder:"内容",rows:"2",type:"textarea"},model:{value:t.value,callback:function(i){e.$set(t,"value",i)},expression:"noFixItem.value"}})],1)],1)],1),e._v(" "),i("el-col",{staticClass:"is-close",attrs:{span:1}},[e.form.noFixedSegList.length>1&&!t.isDefault?i("el-button",{attrs:{type:"text"},on:{click:function(t){e.itemDeleteClick(e.form.noFixedSegList,a)}}},[e._v("删除")]):e._e()],1)],1),e._v(" "),i("div",[e._l(t.items,function(n,s){return i("el-row",{key:a+"-"+s,staticClass:"item-row",attrs:{type:"flex"}},[i("el-col",{attrs:{span:23}},[i("flexbox",[i("el-form-item",{staticStyle:{"padding-left":"140px"},attrs:{prop:"noFixedSegList["+a+"].items["+s+"].itemName",rules:{required:!0,message:"请输入",trigger:"change"},label:""}},[i("el-input",{staticClass:"sub-input sub-input-left",attrs:{disabled:n.isDefault,maxlength:50,placeholder:"标题",resize:"none",rows:"2",type:"textarea"},model:{value:n.itemName,callback:function(t){e.$set(n,"itemName",t)},expression:"item.itemName"}})],1),e._v(" "),i("el-form-item",{staticClass:"div-body",staticStyle:{"margin-left":"-1px"},attrs:{prop:"noFixedSegList["+a+"].items["+s+"].value",rules:{required:!0,message:"请输入",trigger:"change"},label:""}},[i("el-input",{staticClass:"sub-input-right",attrs:{maxlength:200,placeholder:"内容",type:"textarea",rows:"2",resize:"none"},model:{value:n.value,callback:function(t){e.$set(n,"value",t)},expression:"item.value"}})],1)],1)],1),e._v(" "),i("el-col",{staticClass:"is-close",attrs:{span:1}},[i("i",{staticClass:"el-icon-close",on:{click:function(i){e.itemDeleteClick(t.items,s)}}})])],1)}),e._v(" "),i("el-button",{staticStyle:{padding:"0 0 8px 140px"},attrs:{icon:"el-icon-plus",type:"text"},on:{click:function(i){e.subAddClick(t.items)}}},[e._v("添加")])],2)],1)])}),e._v(" "),1==e.form.isEmpWeight?i("el-button",{attrs:{icon:"el-icon-plus",type:"text"},on:{click:function(t){e.bigAddClick(e.form.noFixedSegList)}}},[e._v("添加考核项")]):e._e()],2),e._v(" "),i("div",{staticClass:"eep-right"},[i("div",{staticClass:"epp-right__header"},[e._v("\n            考核记录\n          ")]),e._v(" "),i("performance-history",{ref:"performanceHistory",staticClass:"epp-right__body",attrs:{id:e.id}})],1)],1)]):e._e(),e._v(" "),i("weight-edit-dialog",{attrs:{visible:e.weightEditShow,"surplus-weight":e.dialogEditData.surplusWeight},on:{"update:visible":function(t){e.weightEditShow=t},change:e.weightChange}}),e._v(" "),i("schedule-edit-dialog",{attrs:{visible:e.scheduleEditShow,id:e.dialogEditData.item?e.dialogEditData.item.segId:""},on:{"update:visible":function(t){e.scheduleEditShow=t},change:e.scheduleChange}})],1)])},[],!1,null,"290baca4",null));T.options.__file="EmployeeEditPerformance.vue";var D=T.exports,N=i("wQsH"),E={name:"ScoreEditDialog",components:{},mixins:[i("nboU").a],props:{detail:{required:!0,type:Object,default:function(){return{}}},fullScore:Number,visible:{type:Boolean,required:!0,default:!1}},data:function(){return{loading:!1,levelOptions:[],form:{}}},computed:{title:function(){return"调整考核"+(this.detail?"("+this.detail.employeeName+")":"")}},watch:{visible:{handler:function(e){e&&0==this.levelOptions.length&&this.getLevelList()},immediate:!0}},mounted:function(){},methods:{getLevelList:function(){var e=this;Object(o.g)(this.detail.employeeAppraisalId).then(function(t){e.levelOptions=t.data||[]}).catch(function(){})},getScoreRules:function(){var e=this;return{validator:function(t,i,a){i<0||parseInt(i)>e.fullScore||null===i||void 0===i||""===i?a(new Error("范围在0-"+e.fullScore+"之间")):a()},trigger:["blur"]}},handleCancel:function(){this.form={score:""},this.$refs.scoreForm&&this.$refs.scoreForm.clearValidate(),this.$emit("update:visible",!1)},handleConfirm:function(){var e=this;this.$refs.scoreForm.validate(function(t){t&&(e.loading=!0,e.form.employeeAppraisalId=e.detail.employeeAppraisalId,Object(o.p)(e.form).then(function(t){e.$message.success("操作成功"),e.$emit("change",e.form.schedule),e.handleCancel(),e.loading=!1}).catch(function(){e.loading=!1}),e.$emit("change",e.form.score),e.handleCancel())})}}},L=(i("bZM6"),Object(b.a)(E,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{ref:"wkDialog",attrs:{visible:e.visible,"append-to-body":!0,"close-on-click-modal":!1,title:e.title,width:"600px"},on:{close:e.handleCancel}},[i("div",{staticClass:"form-add-dialog-body"},[i("el-form",{ref:"scoreForm",attrs:{model:e.form,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"当前为"}},[i("el-input",{attrs:{disabled:""},model:{value:e.detail.score,callback:function(t){e.$set(e.detail,"score",t)},expression:"detail.score"}},[i("template",{slot:"append"},[e._v("分")])],2),e._v(" "),i("el-select",{attrs:{disabled:""},model:{value:e.detail.levelId,callback:function(t){e.$set(e.detail,"levelId",t)},expression:"detail.levelId"}},e._l(e.levelOptions,function(e){return i("el-option",{key:e.levelId,attrs:{label:e.levelName,value:e.levelId}})}))],1),e._v(" "),i("el-form-item",{attrs:{label:"调整为"}},[i("el-form-item",{attrs:{rules:e.getScoreRules(),prop:"score",label:""}},[i("el-input",{directives:[{name:"wk-number",rawName:"v-wk-number"}],model:{value:e.form.score,callback:function(t){e.$set(e.form,"score",t)},expression:"form.score"}},[i("template",{slot:"append"},[e._v("分")])],2)],1),e._v(" "),i("el-form-item",{attrs:{rules:{required:!0,message:"请选择",trigger:"change"},prop:"levelId",label:""}},[i("el-select",{model:{value:e.form.levelId,callback:function(t){e.$set(e.form,"levelId",t)},expression:"form.levelId"}},e._l(e.levelOptions,function(e){return i("el-option",{key:e.levelId,attrs:{label:e.levelName,value:e.levelId}})}))],1)],1),e._v(" "),i("el-form-item",{attrs:{rules:{required:!0,message:"请输入",trigger:"change"},prop:"reason",label:"调整理由"}},[i("el-input",{attrs:{autosize:{minRows:3},maxlength:800,type:"textarea",resize:"none"},model:{value:e.form.reason,callback:function(t){e.$set(e.form,"reason",t)},expression:"form.reason"}})],1)],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{nativeOn:{click:function(t){return e.handleCancel(t)}}},[e._v("取消")]),e._v(" "),i("el-button",{directives:[{name:"debounce",rawName:"v-debounce",value:e.handleConfirm,expression:"handleConfirm"}],attrs:{type:"primary"}},[e._v("保存")])],1)])},[],!1,null,"3732de5f",null));L.options.__file="ScoreEditDialog.vue";var I=L.exports,O={name:"ConfirmResultView",components:{EmployeeConfirmPerformance:N.a,ScoreEditDialog:I},props:{id:[String,Number]},data:function(){return{loading:!1,zIndex:Object(x.q)(),detailData:null,rowId:"",detailShow:!1,editData:{},scoreEditShow:!1}},computed:{canHandle:function(){return!!this.detailData&&(1!=this.detailData.isForce||1==this.detailData.hasInRange)}},watch:{id:{handler:function(e){e&&(this.detailData=null,this.getDetail())},immediate:!0}},mounted:function(){},methods:{getDetail:function(){var e=this;this.loading=!0,Object(o.i)(this.id).then(function(t){var i=t.data||{};e.detailData=Object(x.w)(i),e.loading=!1}).catch(function(){e.loading=!1,e.hideView()})},submitClick:function(){var e=this,t="确定要确认通过吗？";0==this.detailData.hasInRange&&(t="等级分布不符合规定比例，确定通过吗？"),this.$confirm(t,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.loading=!0,Object(o.j)(e.id).then(function(t){e.$message.success("操作成功"),e.$emit("change"),e.closeClick(),e.loading=!1}).catch(function(){e.loading=!1})}).catch(function(){e.$message({type:"info",message:"已取消操作"})})},checkEmployeeDetail:function(e){this.rowId=e.employeeAppraisalId,this.detailShow=!0},editScoreClick:function(e){this.editData=e,this.scoreEditShow=!0},closeClick:function(){this.$emit("close")}}},F=(i("SwyX"),Object(b.a)(O,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("transition",{attrs:{name:"opacity-fade"}},[i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"crv",style:{"z-index":e.zIndex}},[e.detailData?i("el-card",{staticClass:"crv-con"},[i("div",{staticClass:"crv-header"},[e._v("\n        绩效结果确认\n        "),i("div",{staticClass:"crv-header__ft"},[i("el-button",{attrs:{disabled:0!==e.detailData.waitingNum&&!e.canHandle,type:"primary"},on:{click:e.submitClick}},[e._v("确认通过")]),e._v(" "),i("el-button",{on:{click:e.closeClick}},[e._v("关闭")])],1)]),e._v(" "),i("div",{staticClass:"crv-body"},[i("div",{staticClass:"crv-des"},[e._v("共"+e._s(e.detailData.totalNum)+"人，待确认"+e._s(e.detailData.waitingNum)+"人")]),e._v(" "),i("div",{staticClass:"crv-list"},e._l(e.detailData.levelDetailInfos,function(t,a){return i("div",{key:a,staticClass:"crv-list-item"},[i("div",{staticClass:"list__header"},[i("span",{staticClass:"label-level"},[e._v(e._s(t.levelName))]),i("span",{staticClass:"label-num"},[e._v("（"+e._s(t.actualNum)+"人）")]),e._v(" "),i("div",{staticClass:"label-des"},[e._v("范围："+e._s(t.minNum)+"-"+e._s(t.maxNum)+"%  现状："+e._s(t.actualWeight)+"%")])]),e._v(" "),i("div",{staticClass:"list__body"},e._l(t.employees,function(t,a){return i("flexbox",{key:a,staticClass:"list-item"},[i("div",{staticClass:"list-item__body"},[i("div",{staticClass:"can-visit--underline",on:{click:function(i){e.checkEmployeeDetail(t)}}},[e._v(e._s(t.employeeName)+"（"+e._s(t.score)+"分）")]),e._v(" "),i("el-tooltip",{attrs:{content:(null==t.deptName?"":t.deptName)+"  "+(null==t.post?"":t.post),effect:"dark",placement:"top"}},[i("div",{staticClass:"des"},[e._v(e._s((null==t.deptName?"":t.deptName)+"  "+(null==t.post?"":t.post)))])])],1),e._v(" "),i("i",{staticClass:"wk wk-edit",on:{click:function(i){e.editScoreClick(t)}}})])}))])}))])]):e._e(),e._v(" "),e.detailShow?i("employee-confirm-performance",{attrs:{id:e.rowId,"handle-type":"evaluato-view"},on:{change:e.getDetail,close:function(t){e.detailShow=!1}}}):e._e(),e._v(" "),i("score-edit-dialog",{attrs:{visible:e.scoreEditShow,detail:e.editData,"full-score":e.detailData?e.detailData.fullScore:0},on:{"update:visible":function(t){e.scoreEditShow=t},change:e.getDetail}})],1)])},[],!1,null,"3bd1aa0c",null));F.options.__file="ConfirmResultView.vue";var $=F.exports,j={name:"PerformanceSelf",components:{XrHeader:r.a,XrTableHeader:c.a,WkPopoverFilter:d.a,EmployeeEditPerformance:D,EmployeeConfirmPerformance:N.a,ConfirmResultView:$},data:function(){return{loading:!1,tableHeight:document.documentElement.clientHeight-195,list:[],currentPage:1,pageSize:15,pageSizes:[15,30,60,100],total:0,search:"",popoverFilterWidth:150,tabType:"my",tabList:[{label:"我的绩效",key:1,name:"my",num:0},{label:"目标待确认",key:2,name:"target",num:0},{label:"结果评定",key:3,name:"evaluato",num:0},{label:"结果待确认",key:4,name:"result",num:0}],mySubTabList:[{label:"待评定",name:"0",key:5,num:0},{label:"已评定",name:"1",key:6,num:0}],evaluatoSubTabList:[{label:"待填写",name:"0",key:7,num:0},{label:"已填写",name:"1",key:8,num:0}],subTabType:"0",rowId:"",rowIndex:"",editHandleType:"",detailShow:!1,confirmHandleType:"",confirmDetailShow:!1,resultConfirmShow:!1,filterObj:{},filterList:[],appraisalId:"",appraisaOptions:[]}},computed:l()({},Object(u.b)(["collapse"]),{searchShow:function(){return"my"!=this.tabType},subTabShow:function(){return"evaluato"==this.tabType||"my"==this.tabType},subTabList:function(){return"evaluato"==this.tabType?this.mySubTabList:this.evaluatoSubTabList},searchPlaceholder:function(){return"result"==this.tabType?"请输入考核名称":"请输入姓名/手机号/考核名称"},appraisaSelectShow:function(){return["target","evaluato"].includes(this.tabType)},fieldList:function(){return this.getTableFileList()},hasFilterContent:function(){if(this.filterObj){for(var e=!1,t=n()(this.filterObj),i=0;i<t.length;i++){var a=t[i];""!=this.filterObj[a]&&this.filterObj[a]!=[]&&null!=this.filterObj[a]&&void 0!=this.filterObj[a]&&(e=!0)}return e}return!1}}),watch:{collapse:{handler:function(e){this.popoverFilterWidth=document.documentElement.clientWidth-(e?89:225)},immediate:!0}},created:function(){var e=this;window.onresize=function(){e.tableHeight=document.documentElement.clientHeight-(e.subTabShow?235:195)},this.handleRouterData(this.$route)},beforeRouteUpdate:function(e,t,i){this.handleRouterData(e),i()},methods:{handleRouterData:function(e){var t=e.query;t&&t.tabType&&(this.tabType=t.tabType,this.subTabType=t.subTabType,t.id&&1==this.subTabType&&(this.rowId=t.id,this.confirmHandleType="evaluato-view",this.confirmDetailShow=!0)),this.refreshList()},getTabsNum:function(){var e=this;Object(o.h)().then(function(t){var i=t.data||{};e.tabList.forEach(function(e,t){e.num=i[e.key]||0}),e.mySubTabList.forEach(function(e,t){e.num=i[e.key]||0}),e.evaluatoSubTabList.forEach(function(e,t){e.num=i[e.key]||0})}).catch(function(){})},resetFilter:function(){this.filterObj={},this.refreshList()},tabClick:function(){var e=this;this.$nextTick(function(){e.tableHeight=document.documentElement.clientHeight-(e.subTabShow?235:195)}),this.subTabType="0",this.search="",this.list=[],this.appraisaSelectShow&&this.getPerformanceList(),this.refreshList()},subTabClick:function(){this.appraisaSelectShow&&this.getPerformanceList(),this.refreshList()},getPerformanceList:function(){var e=this,t={target:o.b,evaluato:o.a}[this.tabType];if(this.appraisaOptions=[],this.appraisalId="",t){var i={};this.subTabShow&&(i.status=this.subTabType),t(i).then(function(t){var i=t.data||[];e.appraisaOptions=[{appraisalId:"",appraisalName:"全部考核"}].concat(i)}).catch(function(){})}},searchClick:function(e){this.search=e,this.refreshList()},refreshList:function(){this.getTabsNum(),this.handleCurrentChange(1)},handleSizeChange:function(e){this.pageSize=e,this.getList()},handleCurrentChange:function(e){this.currentPage=e,this.getList()},getList:function(){var e=this;this.loading=!0;var t={page:this.currentPage,limit:this.pageSize};this.searchShow&&(t.search=this.search),this.subTabShow&&(t.status=this.subTabType),this.appraisalId&&(t.appraisalId=this.appraisalId),(0,{my:o.e,target:o.n,evaluato:o.d,result:o.l}[this.tabType])(t).then(function(t){e.list=t.data.list,e.total=t.data.totalRow,e.loading=!1}).catch(function(){e.loading=!1})},getTableFileList:function(){if("my"==this.tabType)return[{fieldName:"appraisalName",name:"考核名称",width:80},{fieldName:"appraisalTime",name:"考核时间",width:80},{fieldName:"status",name:"考核状态",width:80},{fieldName:"followUpEmployeeName",name:"跟进人",width:80},{fieldName:"score",name:"评分",width:80},{fieldName:"levelName",name:"考核结果",width:80}];if("target"==this.tabType||"evaluato"==this.tabType){return[{fieldName:"employeeName",name:"姓名",width:80},{fieldName:"mobile",name:"手机号",width:80},{fieldName:"deptName",name:"部门",width:80},{fieldName:"appraisalName",name:"考核名称",width:80},{fieldName:"status",name:"考核状态",width:80}]}return"result"==this.tabType?[{fieldName:"appraisalName",name:"考核名称",width:80},{fieldName:"appraisalTime",name:"考核时间",width:80},{fieldName:"totalNum",name:"待确认/总人数",width:80},{fieldName:"scoreLevels",name:"等级分布",width:80}]:[]},fieldFormatter:function(e,t){if("target"==this.tabType){if("status"==t.property)return"待确认";var i=e[t.property];return Object(h.b)(i)?"--":i}if("evaluato"==this.tabType){if("status"==t.property)return{1:"已评定",0:"待评定"}[e[t.property]]||"--";var a=e[t.property];return Object(h.b)(a)?"--":a}if("result"==this.tabType){if("totalNum"==t.property)return e.waitingNum+"/"+e.totalNum;if("scoreLevels"==t.property)return e.scoreLevels?e.scoreLevels.map(function(e){return e.levelName+" "+e.num+"人"}).join("，"):"--";var n=e[t.property];return Object(h.b)(n)?"--":n}if("my"==this.tabType){if("status"==t.property)return m.a.statusValue[e.status]||"--";var s=e[t.property];return Object(h.b)(s)?"--":s}var l=e[t.property];return Object(h.b)(l)?"--":l},cellClassName:function(e){e.row;var t=e.column;e.rowIndex,e.columnIndex;return"result"===this.tabType&&"appraisalName"===t.property?"can-visit--underline":""},getRowButtonName:function(e){return 1===e.isDraft&&1===e.status?"编辑草稿":"my"==this.tabType?1==e.status?"填写":"查看详情":"target"==this.tabType?"确认目标":"evaluato"==this.tabType?0==e.status?"评定":"查看详情":""},handleClick:function(e,t){this.rowId=e.employeeAppraisalId,this.rowIndex=t,"target"==this.tabType?(this.confirmHandleType="confirm",this.confirmDetailShow=!0):"evaluato"==this.tabType?(this.confirmHandleType=0==e.status?"evaluato":"evaluato-view",this.confirmDetailShow=!0):1==e.status||2==e.status?(this.editHandleType="",this.detailShow=!0):3==e.status?(this.editHandleType="schedule",this.detailShow=!0):(this.confirmHandleType="evaluato-view",this.confirmDetailShow=!0)},nextChange:function(e){this.rowId=this.list[e].employeeAppraisalId,this.rowIndex=e},handleRowClick:function(e,t){"result"==this.tabType&&"appraisalName"==t.property&&(this.rowId=e.appraisalId,this.resultConfirmShow=!0)}}},H=(i("gMcK"),Object(b.a)(j,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"performance-self",attrs:{id:"employee-main-container"}},[i("xr-header",{staticStyle:{padding:"0px 15px 15px 0"},attrs:{placeholder:e.searchPlaceholder,"show-search":e.searchShow,content:e.search,"ft-top":"0","search-icon-type":"icon"},on:{"update:content":function(t){e.search=t},search:e.searchClick}},[i("template",{slot:"label"},[i("el-tabs",{on:{"tab-click":e.tabClick},model:{value:e.tabType,callback:function(t){e.tabType=t},expression:"tabType"}},e._l(e.tabList,function(t){return i("el-tab-pane",{key:t.name,attrs:{name:t.name}},[i("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(t.label)),t.num>0?i("span",{staticClass:"tab-pane-num",staticStyle:{"margin-left":"5px"}},[e._v(e._s(t.num))]):e._e()])])}))],1),e._v(" "),e.appraisaSelectShow?i("el-select",{attrs:{slot:"ft",placeholder:"请选择"},on:{change:function(t){e.handleCurrentChange(1)}},slot:"ft",model:{value:e.appraisalId,callback:function(t){e.appraisalId=t},expression:"appraisalId"}},e._l(e.appraisaOptions,function(e){return i("el-option",{key:e.value,attrs:{label:e.appraisalName,value:e.appraisalId}})})):e._e()],2),e._v(" "),i("div",{staticClass:"crm-container"},[e.subTabShow?i("xr-table-header",{staticStyle:{"margin-top":"-20px"}},[i("el-tabs",{staticStyle:{width:"100%","margin-bottom":"-8px"},on:{"tab-click":e.subTabClick},model:{value:e.subTabType,callback:function(t){e.subTabType=t},expression:"subTabType"}},e._l(e.subTabList,function(t){return i("el-tab-pane",{key:t.name,attrs:{name:t.name}},[i("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(t.label)),t.num>0?i("span",{staticClass:"tab-pane-num",staticStyle:{"margin-left":"5px"}},[e._v(e._s(t.num))]):e._e()])])}))],1):e._e(),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"n-table--border el-table-header--white",staticStyle:{width:"100%"},attrs:{id:"crm-table","row-height":40,data:e.list,height:e.tableHeight,"cell-class-name":e.cellClassName,"use-virtual":"",stripe:"",border:"","highlight-current-row":""},on:{"row-click":e.handleRowClick}},[i("el-table-column",{attrs:{prop:"index",label:"序号",width:"80","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.$index+1)+"\n        ")]}}])}),e._v(" "),e._l(e.fieldList,function(t,a){return i("el-table-column",{key:a,attrs:{prop:t.fieldName,label:t.name,"min-width":t.width,formatter:e.fieldFormatter,"show-overflow-tooltip":""}})}),e._v(" "),i("el-table-column"),e._v(" "),"result"!=e.tabType?i("el-table-column",{attrs:{label:"操作",fixed:"right",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text"},on:{click:function(i){e.handleClick(t.row,t.$index)}}},[e._v(e._s(e.getRowButtonName(t.row)))])]}}])}):e._e()],2),e._v(" "),i("div",{staticClass:"p-contianer"},[i("el-pagination",{staticClass:"p-bar",attrs:{"current-page":e.currentPage,"page-sizes":e.pageSizes,"page-size":e.pageSize,total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"update:pageSize":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),e.detailShow?i("employee-edit-performance",{attrs:{"handle-type":e.editHandleType,id:e.rowId},on:{change:e.refreshList,close:function(t){e.detailShow=!1}}}):e._e(),e._v(" "),e.confirmDetailShow?i("employee-confirm-performance",{attrs:{"handle-type":e.confirmHandleType,id:e.rowId,"next-list":e.list,"next-index":e.rowIndex},on:{nextChange:e.nextChange,change:e.refreshList,close:function(t){e.confirmDetailShow=!1}}}):e._e(),e._v(" "),e.resultConfirmShow?i("confirm-result-view",{attrs:{id:e.rowId},on:{change:e.refreshList,close:function(t){e.resultConfirmShow=!1}}}):e._e()],1)},[],!1,null,"11fc0e08",null));H.options.__file="index.vue";t.default=H.exports},CKev:function(e,t,i){},H3Hc:function(e,t,i){},SwyX:function(e,t,i){"use strict";var a=i("gAZs");i.n(a).a},a9la:function(e,t,i){},bZM6:function(e,t,i){"use strict";var a=i("a9la");i.n(a).a},gAZs:function(e,t,i){},gMcK:function(e,t,i){"use strict";var a=i("/Zkf");i.n(a).a}}]);